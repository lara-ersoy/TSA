import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

def compute_acf(series, max_lag=30):
    """
    Compute autocorrelation function for the las 1 up to the max_lag
    """
    acf_vals = []
    r = series.values
    n = len(r)
    mean_r = np.mean(r)
    var_r = np.sum

    for lag in range(1, max_lag+1):
        cov = 0.0
        for t in range(lag, n):
            cov+=(r[t]-mean_r)*(r[t-lag]-mean_r)
        acf_vals.append(cov/var_r)    
        
    for lag in range(1, max_lag + 1):
            cov = 0.0
            for t in range(lag, n):
                cov += (r[t] - mean_r)*(r[t-lag] - mean_r)
            acf_vals.append(cov / var_r)
    
    return acf_vals